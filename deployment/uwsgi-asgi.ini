[uwsgi]
# uWSGI 配置文件（使用 asgiref 適配器運行 FastAPI）
# 路徑: /home/ai-tracks-shopping-react/htdocs/shopping-react.ai-tracks.com/backend
# 
# 注意：uWSGI 不支持原生 ASGI，需要使用 asgiref 將 ASGI 轉換為 WSGI
# 此配置文件使用 wsgi.py（已包含 asgiref 適配器）

plugins = python3
master = true

# 監聽 HTTP socket (匹配 Nginx proxy_pass)
http-socket = 127.0.0.1:8096

# WSGI 應用入口（wsgi.py 已使用 asgiref 適配器將 ASGI 轉換為 WSGI）
wsgi-file = /home/ai-tracks-shopping-react/htdocs/shopping-react.ai-tracks.com/backend/wsgi.py
callable = application

# 工作目錄
chdir = /home/ai-tracks-shopping-react/htdocs/shopping-react.ai-tracks.com/backend

# Python 虛擬環境
virtualenv = /home/ai-tracks-shopping-react/htdocs/shopping-react.ai-tracks.com/backend/.venv

# 進程和線程配置
processes = 8
threads = 2
enable-threads = true

# 緩衝區大小
buffer-size = 65535

# 內存和請求限制
reload-on-rss = 512
max-requests = 1000
max-requests-delta = 500
harakiri = 60

# 權限設置
umask = 0022
uid = ai-tracks-shopping-react
gid = ai-tracks-shopping-react

# 進程管理
die-on-term = true
vacuum = true

# Cheaper mode
cheaper = 2
cheaper-initial = 2
cheaper-step = 2
cheaper-algo = spare

# 日誌
logto = /var/log/uwsgi/shopping-react-backend.log
log-maxsize = 50000000
log-backupcount = 5

